<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>
		<title>Price Action</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link 
			rel="shortcut icon"
			th:href="@{/Icon.png}"
			type="image/x-icon"
			>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

		<!-- GoogleCharts -->
		<!--Load the AJAX API-->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
			crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
		<style>
			header{
				min-width: 50mm;
				padding-bottom: 2mm;
			}
			body{
				min-width: 100mm;
				background-color: gray;
				display: block;
			}
			img{
				width: 70mm;
				height: 50mm;
				max-width: 150mm;
			}
			label{
				text-align: center;
			}

			/*Style para os cards*/
			.carousel{
				width: 300mm;
				padding-top: 3mm;
				background-color:blueviolet;
			}
			.block-size{
				padding-top: 20mm;
				padding-bottom: 40mm;
				display: flex;
				align-items: center;
				justify-content: center;
				align-self: center;
			}
			.carousel-caption{
				background-color: blueviolet;
			}

			/*Style para o conteúdo principal da página*/
			.body-content{
  				background-color: white; /* For browsers that do not support gradients */
  				
				border-radius: 10px;
				min-width: 320mm;
				margin-left: 80mm;
				margin-right: 80mm;
				display: grid; 
				margin-top: 2cm;
				margin-bottom: 1cm;
				padding-top: 2cm; 
				padding-bottom: 2cm;
				align-items: center;
				justify-content: center;
			}

			.text-area{
				border-style: solid;
				border-color: blueviolet;
				border-radius: 10px;
				width: 500px;
				height: 300px;				
			}

			.text-info-area{
				margin-top: 1cm;
				margin-bottom: 1cm;
				border-style: solid;
				border-top-left-radius: 30px;
				border-bottom-right-radius: 30px;
				width: 800px;
				height: 150px;
				background-color: rgb(141, 99, 180);
				text-align: center;
				font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
				align-content: center;
				display: flex;
				text-size-adjust: 20;
				align-items: center;
				justify-content: center;
			}

			.graficos{
				width: 530px; 
				height: 300px;
				border-style: solid;
				border-color: black;
			}

			.card{
				text-align: center;
				align-items: center;
				justify-content: center;
			}

			.info{
				width: 25mm;
				height: 10mm;
				border-style: solid;
				border-color: black;
				border-radius: 15px;
				box-shadow: 3px 3px 3px 1px black;
			}

		</style>
		<script type="text/javascript" th:inline="javascript">
	
			// Load the Visualization API and the corechart package.
			google.charts.load('current', {'packages':['corechart']});
			google.charts.load('current', {'packages':['line']});
	  
			// Set a callback to run when the Google Visualization API is loaded.
			// google.charts.setOnLoadCallback(drawLineChart);
   			// google.charts.setOnLoadCallback(drawCandleStickChart);
			google.charts.setOnLoadCallback(drawCharts);
			var descricao = 'Dados fictícios';
			
			var line_data1 = [[${lineData1}]];
			/*	//   x     y
				[			
					['1',  70.8],
					['2',  30.9],
					['3',  25.4],
					['4',  11.7],
					['5',  11.9],
					['6',   8.8],
					['7',   7.6],
					['8',  12.3],
					['9',  15.8],
					['10', 12.8],
					['11',  5.3],
					['12',  6.6],
					['13',  4.8],
					['14',  7.2]
				];
			*/
			var line_data2 = [[${lineData2}]];
			/*	[
					['1',  80.8],
					['2',  75.4],
					['3',  81.4],
					['4',   69.5],
					['5',  50.9],
					['6',   56.7],
					['7',   40.6],
					['8',  35.6],
					['9',  45.9],
					['10', 23.6],
					['11',  10.3],
					['12',  15.2],
					['13',  4.8],
					['14',  3.4]
				];
			*/
			var line_data3 = [[${lineData3}]];
			/*[			
					['1',  3.8],
					['2',  30.9],
					['3',  25.4],
					['4',  30.7],
					['5',  24.9],
					['6',   17.8],
					['7',   21.6],
					['8',  30.3],
					['9',  28.9],
					['10', 32.8],
					['11',  49.3],
					['12',  50.6],
					['13',  51.8],
					['14',  45.2]
				];
			*/
				var lineDataDefault = 
				[
					['1',  23.8],
					['2',  32.4],
					['3',  25.4],
					['4',  10.5],
					['5',  11.9],
					['6',   7.7],
					['7',   7.6],
					['8',  110.6],
					['9',  16.9],
					['10', 11.6],
					['11',  5.3],
					['12',  5.2],
					['13',  4.8],
					['14',  3.4]
				];
			function drawLineChart(num) {
				
				var nomeAcao = 'AçãoX';//BackEnd envia o nome
				var legenda;
				var data = new google.visualization.DataTable();
				data.addColumn('string', null);

				data.addColumn('number', nomeAcao);//Sugestão de nome pls
				var chart = new google.charts.Line(document.getElementById('linechart'));

				if(num === 1){
					data.addRows(line_data1);
					descricao = 'Valor das acões nos últimos 20 dias';
				}else if(num === 2){
					data.addRows(line_data2);
					descricao = 'Valor das acões nas últimas 20 semanas';
				}else if(num === 3){
					data.addRows(line_data3);
					descricao = 'Valor das acões nos últimos 20 meses';
				}else{
					data.addRows(lineDataDefault);
					legenda = 'Insira o nome da ação no campo de pesquisa para começar a ver dados reais';
				}
			
				var options = {
					chart: {
					title: descricao,
					subtitle: legenda,
					},
					animation: {
						"startup": true,
						duration: 1000,
					},
					vAxis:{
						title:"Valor(R$)",
					},
					legend:{
						position: 'none'
					},
					hAxis:{
						textPosition: 'none'
					},
					colors: ['blueviolet','#004411'],
					titleTextStyle:{
						color: 'black',
						bold: true
					}
				};
				chart.draw(data, google.charts.Line.convertOptions(options));
			}
		
			/*----------------------------------------*/

			var candle_data1 = [[${candleData1}]];
			/*Dados para fazer teste na visualização do gráfico*/
					/*[
					['18/07', 20, 28, 38, 45],
					['19/07', 31, 38, 55, 66],
					['20/07', 50, 55, 77, 80],
					['21/07', 77, 77, 66, 50],
					['22/07', 68, 66, 22, 15],
					['23/07', 30, 49, 55, 60],
					['24/07', 68, 66, 22, 15]
					];
					*/
			var candle_data2 = [[${candleData2}]];
			/*Dados para fazer teste na visualização do gráfico*/
					/*[
					['Sem1', 30, 35, 40, 60],
					['Sem2', 28, 41, 55, 66],
					['Sem3', 65, 40, 69, 80],
					['Sem4', 21, 28, 40, 55],
					['Sem5', 38, 40, 45, 70],
					['sem6', 20, 28, 38, 45],
					['sem7', 31, 38, 55, 66],
					['sem8', 50, 55, 77, 80],
					['sem9', 77, 77, 66, 50],
					['sem10', 68, 66, 22, 15],
					['sem11', 30, 49, 55, 60],
					['sem12', 68, 66, 22, 15]
					];
			*/
			var candle_data3 = [[${candleData3}]];
			/*Dados para fazer teste na visualização do gráfico*/
/*					[
					['MAI', 30, 35, 45, 60],
					['JUN', 28, 41, 55, 66],
					['JUL', 20, 28, 38, 45],
					['AGO', 68, 63, 22, 15],
					['SET', 38, 40, 45, 70]
					];
*/				
			function drawCandleStickChart(num) {
				var data;

				if(num === 1){
					descricao = 'Valor das acões nos últimos 20 dias';
					data = google.visualization.arrayToDataTable(candle_data1, true);
				}else if(num === 2){
					descricao = 'Valor das acões nas últimas 20 semanas';
					data = google.visualization.arrayToDataTable(candle_data2, true);
				}else if(num === 3){
					descricao = 'Valor das acões nos últimos 20 meses';
					data = google.visualization.arrayToDataTable(candle_data3, true);
				}else{
					data = google.visualization.arrayToDataTable(candle_data1, true);
				}

				var options = {
					legend:'none',
					title: descricao,
					animation: {
						"startup": true,
						duration: 1000
					},
					candlestick:{
						fallingColor:{
							fill:"blueviolet"
						},
						risingColor:{
							fill:"white"
						}
					},
					vAxis:{
						title:"Valor(R$)",
					},
					colors: ['blueviolet','#004411'],
					titleTextStyle:{
						color: 'black',
						bold: true
					}
				};
				
				var chart = new google.visualization.CandlestickChart(document.getElementById('candlechart'));

				chart.draw(data, options);				
			}
			
		

			function drawCharts(num){
				/*Se mandar -1 é por que a busca não de resultado, manda 1 para ok na busca*/
				var sh = [[${dadosOK}]];
				if(sh === 1){
					if(num === undefined){
						num = 1;
					}
					drawLineChart(num);
					drawCandleStickChart(num);
					var textInfo1 = document.getElementById('text-info-area1');
					var textInfo2 = document.getElementById('text-info-area2');
					var textInfo3 = document.getElementById('text-info-area3');

					if(num === 1){
						textInfo1.style.display = "";
						textInfo2.style.display = "none";
						textInfo3.style.display = "none";
					}else if(num === 2){
						textInfo2.style.display = "";
						textInfo1.style.display = "none";
						textInfo3.style.display = "none";
					}else{
						textInfo3.style.display = "";
						textInfo1.style.display = "none";
						textInfo2.style.display = "none";
					}

					document.getElementById( 'destino' ).scrollIntoView();
				}else if(sh === -1){//Busca não teve retorno
					document.getElementById('graph-box').style.display = "none";
					alert('Ação não encontrada.');
				}else{//Quando o site abre
					document.getElementById('graph-box').style.display = "none";
				}
			}

		</script>
	</head>

	<body>
		<header>
			<nav class="navbar navbar-dark fixed-top" style="padding-right: 80mm; padding-left: 80mm; background-color: rgba(32, 5, 32, 0.904);">
				<div class="container-fluid">
				  <a class="navbar-brand" href="#">
					  <img th:src="@{/Icon.png}" style="width: 50px; height: 50px;">
					  Price Action
				  </a>
				  <!-- action="/" method="POST" -->
					<form class="d-flex" action="/#destino" method="POST">
					  <input class="form-control me-2" type="text" name="textInput" placeholder='AçãoX' aria-label="Search">
					  <button class="btn btn-outline-success" type="submit">Search</button>
					</form>
				  </div>
				</div>
			  </nav>
		</header>
		<section class="body-content">
				
			<table>
				<tr>
					<td style="padding-right: 3cm;"><img th:src="@{/Analysis.gif}" src="/src/main/resources/static/Analysis.gif"  style="width: 400px; height: 450px;" title="" alt="Imagem Ilustrativa"></td>

					<!--Parte de texto1 stático-->
					<td><div class="text-area">Some text here</div></tr>
				</tr>
				<tr>
					<!--Parte de texto2 stático-->
					<td><div class="text-area">some text here</div></td>
					<td style="padding-left: 3cm;"><img th:src="@{/Cryptoportfolio.gif}" alt="Imagem Ilustrativa" style="width: 400px; height: 450px;"></td>
					
				</tr>
			</table>	

			<div id="destino" style="margin-bottom: 2cm;"></div>

			  	<div id="graph-box">

					<!--Parte de texto "Dinâmico" -->
					<section style="display: flex; align-items: center; justify-content: center;">

						<div class="text-info-area" id="text-info-area1">
							<p>
								O ativo <span th:text="${nomeDaAcao}"/> concluiu com uma abertura no preço <span th:text="${abertura1}"/> e o fechamento de <span th:text="${fechamento1}"/>, obtendo uma variação de<span id="vr" th:text="${variacao1}"/>, com o volume mensurado em <span th:text="${volume1}"/>. Com seus limites chegando a um valor maximo de <span th:text="${max1}"/> e um valor minimo de <span th:text="${min1}"/>.
							</p>

						</div>
						<div class="text-info-area" id="text-info-area2">
							<p> 
								O ativo <span th:text="${nomeDaAcao}"/> concluiu com uma abertura no preço <span th:text="${abertura2}"/> e o fechamento de <span th:text="${fechamento2}"/>, obtendo uma variação de<span id="vr" th:text="${variacao2}"/>, com o volume mensurado em <span th:text="${volume2}"/>. Com seus limites chegando a um valor maximo de <span th:text="${max2}"/> e um valor minimo de <span th:text="${min2}"/>.
							</p>

						</div>
						<div class="text-info-area" id="text-info-area3">
							<p>
								O ativo <span th:text="${nomeDaAcao}"/> concluiu com uma abertura no preço <span th:text="${abertura3}"/> e o fechamento de <span th:text="${fechamento3}"/>, obtendo uma variação de<span id="vr" th:text="${variacao3}"/>, com o volume mensurado em <span th:text="${volume3}"/>. Com seus limites chegando a um valor maximo de <span th:text="${max3}"/> e um valor minimo de <span th:text="${min3}"/>.
							</p>

						</div>
			
					</section>

					<section style="display: grid; align-items: center; justify-content: center; grid-template-columns: 240mm 3cm;">
						<div id="candlechart" style="float: left; height: 450px"></div>
						<div class="btn-group-vertical" role="group" aria-label="Basic radio toggle button group">
								<input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
								<label onclick="drawCharts(1)" class="btn btn-outline-secondary" for="btnradio1">Diário</label>
								
								<input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
								<label onclick="drawCharts(2)" class="btn btn-outline-secondary" for="btnradio2">Semanal</label>
								
								<input type="radio" class="btn-check" name="btnradio" id="btnradio3" autocomplete="off">
								<label onclick="drawCharts(3)" class="btn btn-outline-secondary" for="btnradio3">Mensal</label>
							
						</div>
					</section>
					<section style="display: flex; align-items: center; justify-content: center;">
						<div id="linechart" style="float: left; height: 480px; width: 230mm; padding-top: 10mm; padding-bottom: 10mm;"></div>
					</section>

				</div>
					
		</section>
		
	</body>
</html>